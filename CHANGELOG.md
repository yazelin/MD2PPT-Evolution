# 更新日誌 (Changelog)

本專案的所有重大變更都將記錄在此檔案中。

格式基於 [Keep a Changelog](https://keepachangelog.com/en/1.0.0/)，
並遵循 [語義化版本 (Semantic Versioning)](https://semver.org/spec/v2.0.0.html)。

## [0.5.0] - 2026-01-15

### 新增 (Added)
- **快捷動作側欄 (Quick Action Sidebar)**: 
    - 新增左側可收合工具列，提供一鍵插入投影片、佈局 (Grid, Quote, Alert) 與元件 (Table, Image, Note) 的功能。
    - 支援文字格式化快捷按鈕 (粗體、斜體、代碼)。
- **拖放式資產管理 (Drag & Drop)**:
    - **編輯器拖放**: 將圖片拖入編輯器區域，自動轉換為 Base64 並插入 Markdown 圖片語法。
    - **預覽區拖放**: 將圖片拖至預覽區的特定投影片上，自動設定該頁的 `bgImage` (背景圖片)。
- **YAML 智慧更新**: 實作了 Markdown YAML 解析與更新邏輯，確保拖放操作能精確修改對應投影片的配置。

## [0.4.0] - 2026-01-15

### 新增 (Added)
- **YAML 配置化系統**: 實現「配置與內容分離」，每一張投影片皆可透過 YAML 獨立設定背景顏色、背景圖片、佈局類型與過場動畫。
- **多元專業佈局**: 
    - `center`: 內容垂直水平居中，適合轉場或強調頁。
    - `quote`: 藝術化的大字體引用佈局，自動添加裝飾性引號。
    - `grid`: 靈活的網格系統，支援透過 YAML `columns` 欄位自定義欄數（如 3 欄排列）。
    - `alert`: 醒目的告警框佈局，用於強調核心結論或提示。
- **現代化表格樣式**: 引入 `::: table-modern` 指令，支援生成具備主題色標題列與交錯列底色的 PPTX 原生表格。
- **過場動畫支援**: 支援在 YAML 中定義 `transition`（如 `fade`, `slide`, `zoom`），並在預覽中即時呈現。

### 變更 (Changed)
- **視覺導向分頁**: 正式確立 `===` 為標準分頁符號，大幅提升 Markdown 內容的可讀性與辨識度。
- **預覽介面優化**: 
    - 縮減了預覽 Canvas 的內距與投影片間距。
    - 提升了投影片卡片在容器中的視覺佔比，讓「所見即所得」體驗更清晰。
- **教學內容更新**: 全面翻新預設內容，讓新使用者能立即體驗所有新增佈局與語法。

### 修復 (Fixed)
- **PPTX 引擎同步**: 確保所有新增佈局、背景設定與表格樣式在匯出的 PPTX 檔案中皆能 1:1 還原。
- **圖片預處理增強**: 修復了 YAML 配置中的 `bgImage` 無法正確轉換為 Base64 的問題。

## [0.3.1] - 2026-01-14

### 修復 (Fixed)
- **PPT 匯出損壞**: 修復了因 `PPT_THEME` 中定義了 CSS 風格的字型堆疊（如 `"Segoe UI", "Microsoft JhengHei"`）導致 PptxGenJS 生成無效 XML 結構，進而造成匯出檔案損壞且內容空白的嚴重問題。現在匯出引擎會正確使用單一字型名稱。

## [0.3.0] - 2026-01-14

### 新增 (Added)
- **「琥珀與石墨」商務設計系統**: 全面翻新 UI 配色，改用琥珀暖橘 (`#EA580C`) 與深石墨色 (`#1C1917`)，營造高級商務軟體質感。
- **暖色調視覺優化**: 介面背景採用溫潤的暖白色與石板深色，減輕長時間寫作的視覺壓力。
- **Logo 視覺強化**: 為 Header Logo 設計了專屬的深色容器與濾鏡效果，大幅提升品牌辨識度。
- **智慧對比按鈕**: 「匯出 PPT」主按鈕根據模式自動切換對比色，徹底解決「反白」問題。

### 變更 (Changed)
- **語法階層分明**: 確立了 `===` 為唯一分頁符號，而 `---` 回歸專用於 YAML 設定區塊的標準職責。
- **預覽比例調整**: 增加了投影片內容的內距 (Padding) 並微調縮放算法，讓預覽畫面更具「呼吸感」。
- **全域背景邏輯**: 預設背景全面回歸純白商務風格，僅在顯式指定 YAML `bg` 或 `bgImage` 時才進行覆蓋。

### 修復 (Fixed)
- **解析器穩定性**: 修正了 `splitBlocksToSlides` 的初始化邏輯，解決了首頁可能產生多餘空白頁的問題。
- **圖片路徑處理**: 強化了 Base64 預處理器，確保 `bgImage` (背景圖) 與一般 `IMAGE` 區塊皆能穩定轉換。

## [0.2.0] - 2026-01-14

### 新增 (Added)
- **專業投影片佈局**: 引入了 `two-column` (雙欄)、`impact` (強調頁) 與 `full-bg` (全螢幕背景) 等多種佈局模式。
- **分層配置系統**: 實作了混合語法，使用 `===` 進行分頁，並支援在每頁頂部透過 `---` YAML 區塊進行獨立視覺設定。
- **動態背景支援**: 支援透過投影片 metadata 設定 `bg` (純色背景) 與 `bgImage` (全螢幕背景圖片)。
- **所見即所得 (WYSIWYG) 縮放預覽**: 全新的預覽系統，會根據 1200px 虛擬畫布自動計算縮放比例，確保內容保持一致視覺比例。
- **自動圖片預處理**: 匯出前自動將圖片 URL 轉為 Base64 字串，解決 CORS 限制。

## [0.1.0] - 2026-01-14

### 演進與重生 (Evolution)
- **專案轉型**: 從 `BookPublisher MD2Docx` 正式更名並轉型為 `MD2PPT-Evolution`。
- **核心引擎切換**: 將匯出引擎從 `docx` (Word) 更換為 `pptxgenjs` (PowerPoint)。

## [舊版本 (Legacy Versions)]

### [1.2.8] - 2026-01-09 (MD2Docx)
- Markdown 轉 Word 產生器的最後一個穩定版本。